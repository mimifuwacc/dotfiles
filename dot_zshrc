# Enable homebrew for macOS
if type /opt/homebrew/bin/brew &>/dev/null; then
  eval "$(/opt/homebrew/bin/brew shellenv)"
  FPATH=$(echo "$FPATH" | tr ':' '\n' | grep -v '/opt/homebrew/share/zsh/site-functions' | paste -sd ':' -)
  export HOMEBREW_CASK_OPTS=--no-quarantine
  export PATH=/opt/homebrew/bin:$PATH
fi

# Load zsh plugins from sheldon
if type sheldon &>/dev/null; then
  eval "$(sheldon source)"
fi

# Load starship prompt if available
if type starship &>/dev/null; then
  eval "$(starship init zsh)"
fi

# Load mise
if type mise &>/dev/null; then
  eval "$(mise activate zsh)"
  eval "$(mise activate --shims)"
fi

# Set eza for default ls
if type eza &>/dev/null; then
  alias ls='eza --icons --git --time-style relative'
fi

# Add nvim alias
if type nvim &>/dev/null; then
  alias vim=nvim
  alias v=nvim
fi

# Add kitten ssh if available
if type kitten &>/dev/null; then
  alias ssh='kitten ssh'
fi

# Use gcc-15 and g++-15 if available
if type gcc-15 &>/dev/null && type g++-15 &>/dev/null; then
  alias gcc=gcc-15
  alias g++=g++-15
fi

# History
export HISTFILE=${HOME}/.zsh_history
export HISTSIZE=1000
export SAVEHIST=100000
autoload -Uz history-search-end
zle -N history-beginning-search-backward-end history-search-end
zle -N history-beginning-search-forward-end history-search-end
bindkey "^P" history-beginning-search-backward-end
bindkey "^N" history-beginning-search-forward-end

setopt hist_ignore_dups
setopt inc_append_history
setopt share_history
setopt hist_ignore_all_dups
setopt hist_save_no_dups
setopt hist_expire_dups_first
setopt extended_history

# Other options
setopt mark_dirs
setopt auto_param_slash
setopt auto_cd
setopt auto_menu
setopt correct
setopt interactive_comments
setopt magic_equal_subst
setopt complete_in_word
setopt print_eight_bit
setopt no_beep

# Other aliases
alias a=./a.out
alias ccusage="bunx ccusage@latest"

export EDITOR="code --wait"
